# We need to go to node_modules\ and add a / before the all imports paths that don't start with ~ . \ or /

import os
import re

def fix_relative_references():
  path_to_node_modules = os.path.join(os.path.dirname(os.path.abspath(__file__)), '../node_modules')

  for root, dirs, files in os.walk(path_to_node_modules):
    for file in files:
      if file.endswith('.js'):
        file_path = os.path.join(root, file)
        with open(file_path, 'r') as f:
          file_content = f.read()
          file_content = re.sub(r"((?:from|import)\s*)(['\"]+)([^/\.~].*?\2)", r"\1\2/\3", file_content)
          file_content = re.sub(r"(require\()(['\"]+)([^/\.~].*?\2)", r"\1\2/\3", file_content)
        with open(file_path, 'w') as f:
          f.write(file_content)